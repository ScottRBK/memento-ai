# ============================================
# Forgetful - Environment Configuration
# ============================================
# OPTIONAL: Copy this file to .env (in the docker/ directory) and customize values.
# If no .env file exists, application uses defaults from app/config/settings.py
#
# Standard usage:
#   cd docker
#   cp .env.example .env
#   # Edit .env with your custom values
#   docker compose up -d

# Application Info
SERVICE_NAME=Forgetful
SERVICE_VERSION=v0.1.0
SERVICE_DESCRIPTION="Forgetful Service"

# Server Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8020
LOG_LEVEL=INFO
LOG_FORMAT=json # console or json

# Docker Compose
COMPOSE_PROJECT_NAME=forgetful

# Use 127.0.0.1 for localhost-only (secure, recommended for production)
# Use 0.0.0.0 to expose on all interfaces (development only)
BIND_ADDRESS=127.0.0.1

# Repository Config
# DATABASE options: 'Postgres' or 'SQLite'
# - Use Postgres for production deployments with docker-compose.postgres.yml
# - Use SQLite for simpler deployments with docker-compose.sqlite.yml
DATABASE=Postgres

# PostgreSQL Configuration (when DATABASE=Postgres)
# Use 127.0.0.1 for local development, forgetful-db for Docker deployments
POSTGRES_HOST=forgetful-db
PGPORT=5099
POSTGRES_DB=forgetful
## CHANGE THESE ##
POSTGRES_USER=forgetful
POSTGRES_PASSWORD=forgetful
DB_LOGGING=false

# SQLite Configuration (when DATABASE=SQLite)
# Path is relative to /app in container. With volume mount ./data:/app/data,
# this creates the database at ./data/forgetful.db on the host
SQLITE_PATH=data/forgetful.db
SQLITE_MEMORY=false  # Set to true for in-memory database (ephemeral)

# ============================================
# Authentication Configuration (FastMCP)
# ============================================
# FastMCP provides built-in authentication via environment variables.
# See: https://fastmcp.wiki/en/servers/auth/authentication
#
# Authentication is DISABLED by default (omit FASTMCP_SERVER_AUTH).
# When disabled, all requests use the default user below.
#
# To ENABLE authentication, uncomment and configure FASTMCP_SERVER_AUTH
# with one of the provider options below.

# Default User (used when auth is disabled)
DEFAULT_USER_ID="default-user-id"
DEFAULT_USER_NAME="default-user-name"
DEFAULT_USER_EMAIL="default.user@forgetful.dev"

# ============================================
# Auth Provider Options (choose one)
# ============================================

# --- Option 1: No Authentication (Default) ---
# Omit FASTMCP_SERVER_AUTH or leave it commented out
# All requests use the default user above

# --- Option 2: Token Introspection (OAuth 2.0 RFC 7662) ---
# Validates opaque bearer tokens via introspection endpoint
# FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.introspection.IntrospectionTokenVerifier
# FASTMCP_SERVER_AUTH_INTROSPECTION_URL=https://your-auth-server.com/oauth/introspect
# FASTMCP_SERVER_AUTH_INTROSPECTION_CLIENT_ID=your-client-id
# FASTMCP_SERVER_AUTH_INTROSPECTION_CLIENT_SECRET=your-client-secret
# FASTMCP_SERVER_AUTH_INTROSPECTION_REQUIRED_SCOPES=api:read,api:write

# --- Option 3: JWT Verification ---
# Validates JWT tokens using JWKS endpoint or public key
# FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.jwt.JWTVerifier
# FASTMCP_SERVER_AUTH_JWT_JWKS_URI=https://your-auth-server.com/.well-known/jwks.json
# FASTMCP_SERVER_AUTH_JWT_ISSUER=https://your-auth-server.com
# FASTMCP_SERVER_AUTH_JWT_AUDIENCE=your-api-audience
# FASTMCP_SERVER_AUTH_JWT_REQUIRED_SCOPES=api:read,api:write

# --- Option 4: OAuth Proxy (GitHub, Google, etc.) ---
# Pre-register your app with OAuth provider, proxy to MCP clients
# FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.github.GitHubProvider
# FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=your-github-client-id
# FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=your-github-client-secret
# FASTMCP_SERVER_AUTH_GITHUB_BASE_URL=https://your-server.com
#
# See more examples: https://github.com/jlowin/fastmcp/tree/main/docs/servers/auth

# Memory Configuration
MEMORY_TITLE_MAX_LENGTH=200      # Must be "easily titled" - scannable
MEMORY_CONTENT_MAX_LENGTH=2000   # ~300-400 words - single concept
MEMORY_CONTEXT_MAX_LENGTH=500    # Brief contextual description
MEMORY_KEYWORDS_MAX_COUNT=10     # For semantic clustering
MEMORY_TAGS_MAX_COUNT=10         # For categorization
MEMORY_TOKEN_BUDGET=8000         # token budget for retrieved memories (to protect context window)
MEMORY_MAX_MEMORIES=20           # maximum number of memories that can be retrieved from a query
MEMORY_NUM_AUTO_LINK=3           # number of memories to automatically link (set to 0 to prevent auto linking)

# Search Configuration
EMBEDDING_PROVIDER=FastEmbed
EMBEDDING_MODEL=BAAI/bge-small-en-v1.5
EMBEDDING_DIMENSIONS=384

